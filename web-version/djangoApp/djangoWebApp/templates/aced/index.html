{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IGNITE Recruitment Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <script src="https://unpkg.com/exceljs/dist/exceljs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"
    integrity="sha512-csNcFYJniKjJxRWRV1R7fvnXrycHP6qDR21mgz1ZP55xY5d+aHLfo9/FcGDQLfn2IfngbAHd8LdfsagcCqgTcQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <style>
    body {
      margin: 20px;
    }

    .table th,
    .table td {
      text-align: right;
    }

    .highlight {
      background-color: #baddf1 !important;
      font-size: 18px;
      text-align: left !important;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <!-- Menu -->
  <nav class="navbar bg-body-tertiary fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Navigation Bar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
        aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
            List of Projects
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>

        <div class="offcanvas-body">
          <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="{% url 'protected_page' %}">PIVOT</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="{% url 'ignite_report' %}">IGNITE</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="{% url 'aced_report' %}">ACE-D</a>
            </li>
            <li class="nav-item">
              <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button class="mt-5 btn btn-dark" type="submit">
                  Log Out
                </button>
              </form>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  <div class="container">
    <h2 class="text-center title-page my-3">ACE-D Recruitment Report</h2>

    <ul class="nav nav-tabs mt-5" id="igniteTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="summary-tab" data-bs-toggle="tab" data-bs-target="#summary" type="button"
          role="tab">
          Summary Report
        </button>
      </li>
      <!-- <li class="nav-item" role="presentation">
        <button class="nav-link" id="detailed-tab" data-bs-toggle="tab" data-bs-target="#detailed" type="button"
          role="tab">
          Detailed Staff Report
        </button>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="selfharm-tab" data-bs-toggle="tab" href="#selfharm" role="tab">Self-Harm Summary</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="intervention-tab" data-bs-toggle="tab" href="#intervention" role="tab">Intervention Report</a>
      </li> -->
    </ul>

    <div class="tab-content" id="igniteTabContent">
      <div class="tab-pane fade show active" id="summary" role="tabpanel">
        <!-- This wraps your existing summary report content -->
        <div class="container">
          <!-- EXISTING CONTENT (summary table and date selector) GOES HERE -->
          <div class="row my-3">
            <div class="col">
              <label for="startDateSelect">Compare data from:</label>
              <input type="date" class="form-control" id="startDateSelect" />
            </div>
            <div class="col">
              <label for="endDateSelect">to:</label>
              <input type="date" class="form-control" id="endDateSelect" />
            </div>
            <div class="col d-flex align-items-end">
              <button id="show-results-btn" class="btn btn-primary" onclick="getSummariesAndDisplay()">
                <span id="show-results-text">Show Results</span>
                <span id="show-results-spinner" class="spinner-border spinner-border-sm text-white ms-2" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </span>
              </button>
              <!-- <button class="btn btn-warning ms-2" onclick="exportToExcel()">id="export-btn" -->
              <button class="btn btn-secondary-outline ms-2" onclick="populateStaticData()">
                Populate Static Data
              </button>
              <button class="btn btn-warning ms-2" id="export-btn">
                Download to Excel
              </button>
            </div>
          </div>

            <table class="table table-bordered table-sm align-middle text-center" id="recruitment-table">
                <thead class="table-dark">
                    <tr>
                        <th rowspan="2">Recruitment Invitations</th>
                        <th colspan="3" class="bg-secondary-subtle">Cumulative</th>
                        <th colspan="3" class="bg-warning-subtle">Stanford</th>
                        <th colspan="3" class="bg-primary-subtle">UIC</th>
                    </tr>
                    <tr>
                        <th>Total</th>
                        <th>%</th>
                        <th>Weekly</th>
                        <th>Total</th>
                        <th>%</th>
                        <th>Change</th>
                        <th>Total</th>
                        <th>%</th>
                        <th>Change</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Invitations sent</td><td colspan="6"></td>
                    <td id="uic-site-1--invite_sent"></td><td></td><td></td></tr>

                <tr><td>Within 2-week wait</td><td colspan="6"></td>
                    <td id="uic-site-1--two_week_wait"></td><td></td><td></td></tr>

                <tr><td>Calling in-progress</td><td colspan="6"></td>
                    <td id="uic-site-1--calling_in_progress"></td><td></td><td></td></tr>

                <tr><td>Ceased outreach</td><td>101</td><td></td><td></td><td>0</td><td></td><td></td>
                    <td id="uic-site-1--ceased_outreach"></td><td></td><td></td></tr>

                <tr><td>Requested call (via Website or Twilio)</td><td>3</td><td></td><td></td><td>3</td><td></td><td></td>
                    <td id="uic-site-1--requested_call"></td><td></td><td></td></tr>

                <tr><td>Partial Screen</td><td>98</td><td></td><td></td><td>90</td><td></td><td></td>
                    <td id="uic-site-1--partial_screen"></td><td></td><td></td></tr>

                <tr class="table-secondary fw-bold"><td>Not Screened</td><td>45</td><td></td><td></td><td>0</td><td></td><td></td>
                    <td id="uic-site-1--not_screened"></td><td></td><td></td></tr>

                <tr><td>Ineligible prior to screen</td><td>14</td><td></td><td></td><td>0</td><td></td><td></td>
                    <td id="uic-site-1--ineligible_prior_to_screen"></td><td></td><td></td></tr>

                <tr><td>Declined to screen</td><td>31</td><td></td><td></td><td>0</td><td></td><td></td>
                    <td id="uic-site-1--declined_to_screen"></td><td></td><td></td></tr>

                <tr class="table-secondary fw-bold"><td>Screened</td><td>193</td><td></td><td></td><td>100</td><td></td><td></td>
                    <td id="uic-site-1--screened"></td><td></td><td></td></tr>

                <tr><td>Ineligible</td><td>132</td><td>68%</td><td></td><td>56</td><td>56%</td><td></td>
                    <td id="uic-site-1--ineligible"></td><td></td><td></td></tr>

                <tr><td>Eligible - Declined TO</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--eligible_but_declined_to"></td><td></td><td></td></tr>

                <tr><td>Eligible - Undecided</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--eligible_undecided"></td><td></td><td></td></tr>

                <tr class="fw-bold"><td>Eligible</td><td>61</td><td>32%</td><td></td><td>44</td><td>44%</td><td></td>
                    <td id="uic-site-1--screened_eligible"></td><td></td><td></td></tr>

                <tr><td>EHR mismatch to be resolved</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--ehr_mismatch"></td><td></td><td></td></tr>

                <tr class="table-light fw-bold"><td>Tele-Orientation</td><td>61</td><td></td><td></td><td>44</td><td></td><td></td>
                    <td id="uic-site-1--to_schedule"></td><td></td><td></td></tr>

                <tr><td>Appointment declined/ceased</td><td>1</td><td>2%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--appt_declined"></td><td></td><td></td></tr>

                <tr><td>Appointment needed within wk since IES</td><td>12</td><td>20%</td><td></td><td>11</td><td>25%</td><td></td>
                    <td id="uic-site-1--appt_needed_within_week_since_ies"></td><td></td><td></td></tr>

                <tr><td>Appointment needed over 1 wk since IES</td><td>6</td><td>10%</td><td></td><td>6</td><td>14%</td><td></td>
                    <td id="uic-site-1--appt_needed_over_week_since_ies"></td><td></td><td></td></tr>

                <tr><td>Reschedule No-show</td><td>5</td><td>8%</td><td></td><td>3</td><td>7%</td><td></td>
                    <td id="uic-site-1--reschedule_no_show"></td><td></td><td></td></tr>

                <tr><td class="fw-bold">TO Scheduled</td><td>2</td><td>3%</td><td></td><td>1</td><td>2%</td><td></td>
                    <td id="uic-site-1--to_scheduled"></td><td></td><td></td></tr>

                <tr class="table-secondary fw-bold"><td>Tele-Orientation Attended</td><td>36</td><td>59%</td><td></td><td>24</td><td>55%</td><td></td>
                    <td id="uic-site-1--to_attended"></td><td></td><td></td></tr>

                <tr><td>Declined ICF</td><td>1</td><td>3%</td><td></td><td>1</td><td>4%</td><td></td>
                    <td id="uic-site-1--declined_icf"></td><td></td><td></td></tr>

                <tr class="fw-bold"><td>Consented</td><td>34</td><td>94%</td><td></td><td>22</td><td>92%</td><td></td>
                    <td id="uic-site-1--consented"></td><td></td><td></td></tr>

                <tr><td class="ps-4">Agreed BiAffect, w/ iPhone</td><td>14</td><td>41%</td><td></td><td>9</td><td>41%</td><td></td>
                    <td id="uic-site-1--consented_biaffect"></td><td></td><td></td></tr>

                <tr><td class="ps-4">Agreed NDA</td><td>29</td><td>85%</td><td></td><td>18</td><td>82%</td><td></td>
                    <td id="uic-site-1--consented_nda"></td><td></td><td></td></tr>

                <tr><td>Ineligible at TO</td><td>2</td><td>6%</td><td></td><td>2</td><td>8%</td><td></td>
                    <td id="uic-site-1--ineligible_at_to"></td><td></td><td></td></tr>

                <tr><td>Declined to proceed</td><td>1</td><td>3%</td><td></td><td>1</td><td>5%</td><td></td>
                    <td id="uic-site-1--to_declined_to_proceed"></td><td></td><td></td></tr>

                <tr><td>Eligible - Undecided</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--to_elig_undecided"></td><td></td><td></td></tr>

                <tr><td>Eligible - Pending MD Clearance</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--to_elig_pending_md_clearance"></td><td></td><td></td></tr>

                <tr class="fw-bold"><td>Consented and Eligible</td><td>33</td><td>92%</td><td></td><td>21</td><td>88%</td><td></td>
                    <td id="uic-site-1--consesnted_and_eligible"></td><td></td><td></td></tr>


                    <tr class="table-light fw-bold"><td colspan="10">T1 Baseline</td></tr>
                    <tr><td>Pre-window</td><td>4</td><td></td><td></td><td>3</td><td></td><td></td>
                        <td id="uic-site-1--t1_baseline_prewindow">1</td><td></td><td></td></tr>

                    <tr><td>T1 now in-window</td><td>5</td><td></td><td></td><td>2</td><td></td><td></td>
                        <td id="uic-site-1--t1_baseline_inwindow">3</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td><em>T1 Complete - Fully enrolled</em></td><td>24</td><td>73%</td><td></td><td>16</td><td>76%</td><td></td>
                        <td id="uic-site-1--t1_baseline_complete_fully_enrolled">8</td><td>67%</td><td></td></tr>

                    <tr><td>T1 incomplete (WebNeuro only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t1_baseline_incomplete_webneuro_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T1 incomplete (PROs only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t1_baseline_incomplete_pros_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T1 Missing</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t1_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr><td class="text-primary fw-bold">Tri-yearly Target: 8/1/25</td><td>48</td><td></td><td></td><td>24</td><td></td><td></td>
                        <td><!-- Static -->24</td><td></td><td></td></tr>

                    <tr><td class="text-primary">% of target</td><td></td><td>50%</td><td></td><td></td><td>67%</td><td></td>
                        <td><!-- Static -->33%</td><td></td><td></td></tr>

                    <tr class="table-light fw-bold"><td colspan="10">Timepoint 2</td></tr>
                    <tr><td>T2 Pre-window</td><td>4</td><td></td><td></td><td>2</td><td></td><td></td>
                        <td id="uic-site-1--t2_baseline_prewindow">2</td><td></td><td></td></tr>

                    <tr><td>T2 Now in-window</td><td>3</td><td></td><td></td><td>3</td><td></td><td></td>
                        <td id="uic-site-1--t2_baseline_inwindow">0</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td>T2 Complete</td><td>17</td><td>85%</td><td></td><td>11</td><td>79%</td><td></td>
                        <td id="uic-site-1--t2_baseline_complete_fully_enrolled">6</td><td>100%</td><td></td></tr>

                    <tr><td>T2 incomplete (WebNeuro only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t2_baseline_incomplete_webneuro_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T2 incomplete (PROs only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t2_baseline_incomplete_pros_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T2 Missing</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t2_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr class="fw-bold"><td>Total entered T2 window:</td><td>20</td><td></td><td></td><td>14</td><td></td><td></td>
                        <td id="uic-site-1--t2_baseline_total_entered">6</td><td></td><td></td></tr>

                    <tr class="table-light fw-bold"><td colspan="10">Timepoint 3</td></tr>
                    <tr><td>T3 Pre-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t3_baseline_prewindow">0</td><td></td><td></td></tr>

                    <tr><td>T3 Now in-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t3_baseline_inwindow">0</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td>T3 Complete</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t3_baseline_complete_fully_enrolled">0</td><td>0%</td><td></td></tr>

                    <tr><td>T3 incomplete (WebNeuro only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t3_baseline_incomplete_webneuro_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T3 incomplete (PROs only)</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t3_baseline_incomplete_pros_only">0</td><td>0%</td><td></td></tr>

                    <tr><td>T3 Missing</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t3_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr class="fw-bold"><td>Total entered T3 window:</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t3_baseline_total_entered">0</td><td></td><td></td></tr>

                    <tr class="table-light fw-bold"><td colspan="10">Timepoint 4</td></tr>
                    <tr><td>T4 Pre-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t4_baseline_prewindow">0</td><td></td><td></td></tr>

                    <tr><td>T4 Now in-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t4_baseline_inwindow">0</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td>T4 Complete</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t4_baseline_complete_fully_enrolled">0</td><td>0%</td><td></td></tr>

                    <tr><td>T4 Missing PROs</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t4_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr class="fw-bold"><td>Total entered T4 window:</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t4_baseline_total_entered">0</td><td></td><td></td></tr>


                    <tr class="table-light fw-bold"><td colspan="10">Timepoint 5</td></tr>

                    <tr><td>T5 Pre-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t5_baseline_prewindow">0</td><td></td><td></td></tr>

                    <tr><td>T5 Now in-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t5_baseline_inwindow">0</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td>T5 Complete</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t5_baseline_complete_fully_enrolled">0</td><td>0%</td><td></td></tr>

                    <tr><td>T5 Missing PROs</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t5_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr class="fw-bold"><td>Total entered T5 window:</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t5_baseline_total_entered">0</td><td></td><td></td></tr>

                    <tr class="table-light fw-bold"><td colspan="10">Timepoint 6</td></tr>

                    <tr><td>T6 Pre-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t6_baseline_prewindow">0</td><td></td><td></td></tr>

                    <tr><td>T6 Now in-window</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t6_baseline_inwindow">0</td><td></td><td></td></tr>

                    <tr class="fw-bold"><td>T6 Complete</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t6_baseline_complete_fully_enrolled">0</td><td>0%</td><td></td></tr>

                    <tr><td>T6 Missing PROs</td><td>0</td><td>0%</td><td></td><td>0</td><td>0%</td><td></td>
                        <td id="uic-site-1--t6_baseline_missing">0</td><td>0%</td><td></td></tr>

                    <tr class="fw-bold"><td>Total entered T6 window:</td><td>0</td><td></td><td></td><td>0</td><td></td><td></td>
                        <td id="uic-site-1--t6_baseline_total_entered">0</td><td></td><td></td></tr>


                    <!-- </tbody>
                </table> -->
                    <!-- IGNORE THIS BELOW LINE -->
                    <tr><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td><td style="visibility: hidden;">_blank</td></tr>
                    <!-- IGNORE THIS ABOVE LINE -->

                    <tr class="table-secondary fw-bold">
                    <td>Final Disposition</td><td colspan="3"></td><td colspan="3"></td><td colspan="3"></td>
                    </tr>

                    <tr>
                    <td>Off-study:</td>
                    <td>0</td><td>0%</td><td></td>
                    <td>0</td><td>0%</td><td></td>
                    <td id="uic-site-1--off_study">0</td><td>0%</td><td></td>
                    </tr>

                    <tr>
                    <td>Withdrawn:</td>
                    <td>0</td><td>0%</td><td></td>
                    <td>0</td><td>0%</td><td></td>
                    <td><!-- no direct key, handled in subtotals --></td><td>0%</td><td></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 1</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t1">0</td><td colspan="2"></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 2</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t2">0</td><td colspan="2"></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 3</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t3">0</td><td colspan="2"></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 4</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t4">0</td><td colspan="2"></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 5</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t5">0</td><td colspan="2"></td>
                    </tr>

                    <tr>
                    <td class="ps-4">Timepoint 6</td>
                    <td>0</td><td colspan="2"></td>
                    <td>0</td><td colspan="2"></td>
                    <td id="uic-site-1--withdraw_t6">0</td><td colspan="2"></td>
                    </tr>

                </tbody>
            </table>
        </div>
      </div>
    </div>

  </div>

</body>

</html>

<style scoped>
  .title-page {
    margin-top: 8vh !important;
  }
</style>

<script>
  const serverUrl = "http://localhost:8000";

  function populateACEDTable(data) {
    const siteName = "UIC Site 1";
    const siteIdPrefix = "uic-site-1";

    if (!data[siteName]) {
        console.error(`Site "${siteName}" not found in data`);
        return;
    }

    const siteData = data[siteName];

    // Helper to safely set text
    function setCellValue(id, value) {
        const el = document.getElementById(id);
        if (el) {
        el.textContent = value;
        } else {
        console.warn(`Element with id "${id}" not found.`);
        }
    }

    // Populate values from siteData
    for (const [key, value] of Object.entries(siteData)) {
            // Normalize key → remove _count suffix for consistency with IDs
            const normalizedKey = key.replace(/_count$/, "");
            const id = `${siteIdPrefix}--${normalizedKey}`;
            setCellValue(id, value);
        }
    }

    const staticData = {'UIC Site 1': {'ineligible_prior_to_screen_count': 16, 'declined_to_screen_count': 58, 'ineligible_count': 127, 'eligible_but_declined_to_count': 1, 'eligible_undecided_count': 0, 'screened_eligible_count': 42, 'ehr_mismatch_count': 0, 'appt_declined_count': 1, 'appt_needed_within_week_since_ies_count': 10, 'appt_needed_over_week_since_ies_count': 4, 'reschedule_no_show_count': 2, 'to_schedule_count': 26, 'to_attended_count': 244, 'ineligible_at_to_count': 2, 'declined_icf_count': 0, 'to_declined_to_proceed_count': 0, 'to_elig_undecided_count': 0, 'to_elig_pending_md_clearance_count': 0, 'consented_count': 21, 'consented_biaffect_count': 11, 'consented_nda_count': 19, 'consesnted_and_eligible_count': 19, 't1_baseline_prewindow_count': 0, 't1_baseline_inwindow_count': 1, 't1_baseline_complete_fully_enrolled_count': 0, 't1_baseline_incomplete_webneuro_only_count': 0, 't1_baseline_incomplete_pros_only_count': 0, 't1_baseline_missing_count': 0, 't2_baseline_prewindow_count': 0, 't2_baseline_inwindow_count': 0, 't2_baseline_complete_fully_enrolled_count': 0, 't2_baseline_incomplete_webneuro_only_count': 0, 't2_baseline_incomplete_pros_only_count': 0, 't2_baseline_missing_count': 0, 't2_baseline_total_entered_count': 0, 't3_baseline_prewindow_count': 0, 't3_baseline_inwindow_count': 0, 't3_baseline_complete_fully_enrolled_count': 0, 't3_baseline_incomplete_webneuro_only_count': 0, 't3_baseline_incomplete_pros_only_count': 0, 't3_baseline_total_entered_count': 0, 't4_baseline_prewindow_count': 0, 't4_baseline_inwindow_count': 0, 't4_baseline_complete_fully_enrolled_count': 0, 't4_baseline_missing_count': 0, 't4_baseline_total_entered_count': 0, 't5_baseline_prewindow_count': 0, 't5_baseline_inwindow_count': 0, 't5_baseline_complete_fully_enrolled_count': 0, 't5_baseline_missing_count': 0, 't5_baseline_total_entered_count': 0, 't6_baseline_prewindow_count': 0, 't6_baseline_inwindow_count': 0, 't6_baseline_complete_fully_enrolled_count': 0, 't6_baseline_missing_count': 0, 't6_baseline_total_entered_count': 0, 'off_study_count': 0, 'withdraw_t1_count': 0, 'withdraw_t2_count': 0, 'withdraw_t3_count': 0, 'withdraw_t4_count': 0, 'withdraw_t5_count': 0, 'withdraw_t6_count': 0, 'invite_sent_count': 1919, 'two_week_wait_count': 360, 'calling_in_progress_count': 1217, 'ceased_outreach_count': 126, 'requested_call_count': 1, 'partial_screen_count': 29}, 'UIC Site 1 - Invitations Sent': 1919, 'UIC Site 1 - Two Week Wait': 360, 'UIC Site 1 - Calling in Progress': 1217, 'UIC Site 1 - Ceased Outreach': 126, 'UIC Site 1 - Requested Call': 1, 'UIC Site 1 - Partial Screen': 29, 'UIC Site 1 - Ineligible Prior to Screen': 16, 'UIC Site 1 - Declined to Screen': 58, 'UIC Site 1 - Ineligible Count': 127, 'UIC Site 1 - Eligible but Declined TO': 1, 'UIC Site 1 - Eligible Undecided': 0, 'UIC Site 1 - Screened Eligible': 42, 'UIC Site 1 - EHR Mismatch': 0, 'UIC Site 1 - Appointment Declined': 1, 'UIC Site 1 - Appointment Needed Within Week Since IES': 10, 'UIC Site 1 - Appointment Needed Over Week Since IES': 4, 'UIC Site 1 - Reschedule No Show': 2, 'UIC Site 1 - To Schedule': 26, 'UIC Site 1 - To Attended': 244, 'UIC Site 1 - Ineligible at TO': 2, 'UIC Site 1 - Declined ICF': 0, 'UIC Site 1 - Declined to Proceed at TO': 0, 'UIC Site 1 - Eligible Undecided at TO': 0, 'UIC Site 1 - Eligible Pending MD Clearance at TO': 0, 'UIC Site 1 - Consented': 21, 'UIC Site 1 - Consented Biaffect': 11, 'UIC Site 1 - Consented NDA': 19, 'UIC Site 1 - Consented and Eligible': 19, 'T1 Baseline Prewindow': 0, 'T1 Baseline Inwindow': 1, 'T1 Baseline Complete Fully Enrolled': 0, 'T1 Baseline Incomplete Webneuro Only': 0, 'T1 Baseline Incomplete Pros Only': 0, 'T1 Baseline Missing': 0, 'T2 Baseline Prewindow': 0, 'T2 Baseline Inwindow': 0, 'T2 Baseline Complete Fully Enrolled': 0, 'T2 Baseline Incomplete Webneuro Only': 0, 'T2 Baseline Incomplete Pros Only': 0, 'T2 Baseline Missing': 0, 'T2 Baseline Total Entered': 0, 'T3 Baseline Prewindow': 0, 'T3 Baseline Inwindow': 0, 'T3 Baseline Complete Fully Enrolled': 0, 'T3 Baseline Incomplete Webneuro Only': 0, 'T3 Baseline Incomplete Pros Only': 0, 'T3 Baseline Missing': 0, 'T3 Baseline Total Entered': 0, 'T4 Baseline Prewindow': 0, 'T4 Baseline Inwindow': 0, 'T4 Baseline Complete Fully Enrolled': 0, 'T4 Baseline Missing': 0, 'T4 Baseline Total Entered': 0, 'T5 Baseline Prewindow': 0, 'T5 Baseline Inwindow': 0, 'T5 Baseline Complete Fully Enrolled': 0, 'T5 Baseline Missing': 0, 'T5 Baseline Total Entered': 0, 'T6 Baseline Prewindow': 0, 'T6 Baseline Inwindow': 0, 'T6 Baseline Complete Fully Enrolled': 0, 'T6 Baseline Missing': 0, 'T6 Baseline Total Entered': 0, 'Off Study': 0, 'Withdraw T1': 0, 'Withdraw T2': 0, 'Withdraw T3': 0, 'Withdraw T4': 0, 'Withdraw T5': 0, 'Withdraw T6': 0};

    function populateStaticData () {
        populateACEDTable(staticData);
    }

    function clearAllACEDFields() {
        const allSiteCells = document.querySelectorAll('[id*="--"]');
        allSiteCells.forEach(cell => cell.textContent = "");
    }

    document.addEventListener("DOMContentLoaded", () => {
        clearAllACEDFields();
    });

</script>

  
